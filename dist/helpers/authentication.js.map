{"version":3,"sources":["../../src/helpers/authentication.js"],"names":["createJwtToken","payload","secretKey","process","env","SECRET_KEY","token","jwt","sign","algorithm","error","Error","decodeToken","decoded","verify"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEO,MAAMA,cAAc,GAAG,MAAMC,OAAN,IAAiB;AAC7C,MAAI;AACF,UAAMC,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYC,UAA9B;AACA,UAAMC,KAAK,GAAG,MAAMC,sBAAIC,IAAJ,CAASP,OAAT,EAAkBC,SAAlB,EAA6B;AAAEO,MAAAA,SAAS,EAAE;AAAb,KAA7B,CAApB;AACA,WAAOH,KAAP;AACD,GAJD,CAIE,OAAOI,KAAP,EAAc;AACd,UAAM,IAAIC,KAAJ,CAAU,yBAAV,CAAN;AACD;AACF,CARM;;;;AAUA,MAAMC,WAAW,GAAG,MAAMN,KAAN,IAAe;AACxC,MAAI;AACF,UAAMJ,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYC,UAA9B;AACA,UAAMQ,OAAO,GAAG,MAAMN,sBAAIO,MAAJ,CAAWR,KAAX,EAAkBJ,SAAlB,CAAtB;AACA,WAAOW,OAAP;AACD,GAJD,CAIE,OAAOH,KAAP,EAAc;AACd,UAAM,IAAIC,KAAJ,CAAU,mCAAV,CAAN;AACD;AACF,CARM","sourcesContent":["import jwt from \"jsonwebtoken\";\nimport dotenv from \"dotenv\";\n\nexport const createJwtToken = async payload => {\n  try {\n    const secretKey = process.env.SECRET_KEY;\n    const token = await jwt.sign(payload, secretKey, { algorithm: \"HS256\" });\n    return token;\n  } catch (error) {\n    throw new Error(\"error is happening over\");\n  }\n};\n\nexport const decodeToken = async token => {\n  try {\n    const secretKey = process.env.SECRET_KEY;\n    const decoded = await jwt.verify(token, secretKey);\n    return decoded;\n  } catch (error) {\n    throw new Error(\"We are unable to authenticate you\");\n  }\n};\n"],"file":"authentication.js"}